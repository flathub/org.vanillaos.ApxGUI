id: org.vanillaos.ApxGUI
runtime: org.gnome.Platform
runtime-version: '49'
sdk: org.gnome.Sdk
sdk-extensions:
  - org.freedesktop.Sdk.Extension.golang
command: apx-gui

finish-args:
  - --share=ipc
  - --socket=fallback-x11
  - --socket=wayland
  - --device=dri
  - --talk-name=org.freedesktop.Flatpak

modules:
  - name: apx
    buildsystem: simple
    build-options:
      append-path: /usr/lib/sdk/golang/bin
    build-commands:
      - go build -o /app/bin/apx -mod=vendor ./cmd
    sources:
      - type: git
        url: https://github.com/Vanilla-OS/apx.git
        tag: v3.0.1
        commit: 4927bae852e62607c0c1bde11b442744b19644b5
        x-checker-data:
          type: json
          url: https://api.github.com/repos/Vanilla-OS/apx/releases/latest
          tag-query: .tag_name
      - go.mod.yml

  - name: apx-configs
    buildsystem: simple
    build-commands:
      - mkdir -p /app/share/apx
      - mv * /app/share/apx
    sources:
      - type: git
        url: https://github.com/Vanilla-OS/vanilla-apx-configs.git
        tag: v1.0.0
        commit: 691d7c737b0fff095f81adfca4736aecc318beaa
        x-checker-data:
          type: json
          url: https://api.github.com/repos/Vanilla-OS/vanilla-apx-configs/releases/latest
          tag-query: .tag_name
      - type: file
        path: config.json

  - name: fast_float
    buildsystem: cmake-ninja
    sources:
      - type: git
        url: https://github.com/fastfloat/fast_float.git
        tag: v8.2.3
        commit: 01ce95dfe46abccf3264fbccf9f5139ea9016cd2
        x-checker-data:
          type: anitya
          project-id: 214353
          tag-template: v$version

  - name: simdutf
    buildsystem: cmake-ninja
    sources:
      - type: git
        url: https://github.com/simdutf/simdutf.git
        tag: v8.0.0
        commit: 7f3757fba1b426e7f583011ba7bc4e700a8fbb1a
        x-checker-data:
          type: anitya
          project-id: 378662
          tag-template: v$version

  - name: vte
    buildsystem: meson
    config-opts:
      - -Dapp=false
      - -Dglade=false
      - -Dgtk3=false
      - -Dvapi=false
    sources:
      - type: archive
        url: https://download.gnome.org/sources/vte/0.83/vte-0.83.90.tar.xz
        sha256: a43441a78f8893268ae927e7bae3b17ffe669913ed954e172fbd12d3e083e286
        x-checker-data:
          type: gnome
          name: vte

  - python3-requests.json

  - python3-PyYAML.json

  - name: apx-gui
    buildsystem: meson
    sources:
      - type: git
        url: https://github.com/Vanilla-OS/apx-gui.git
        tag: v1.0.6
        commit: b2bc5af45c70cbdfd361a7271dfa200d9a383bdf
        x-checker-data:
          type: json
          url: https://api.github.com/repos/Vanilla-OS/apx-gui/releases/latest
          tag-query: .tag_name
